FROM scannerresearch/esper-base:cpu
ARG spark_version=2.3.0

WORKDIR /opt
RUN wget -q http://apache.mirrors.tds.net/spark/spark-${spark_version}/spark-${spark_version}-bin-hadoop2.7.tgz && \
    tar -xf spark-${spark_version}-bin-hadoop2.7.tgz && \
    rm spark-${spark_version}-bin-hadoop2.7.tgz
WORKDIR /opt/spark-${spark_version}-bin-hadoop2.7
CMD ./sbin/start-master.sh -h 0.0.0.0 && \
    ./sbin/start-slave.sh spark://localhost:7077 && \
    sleep infinity